class SuggestplacesController < ApplicationController
	skip_before_action :verify_authenticity_token
	respond_to :html, :json, :xml	
	require 'rubygems'
	require 'RMagick'
	require "open-uri"
	require 'json'
	require 'net/http'
	include Magick
	
	TOP_N = 1
	
	def api2
		rjson2 = Array.new
		if(params[:qtype] == "[]")
			poiLocs = Array.new
			tweetLocs = Array.new
			bboxescentre = Array.new
			bboxesccolors = Array.new
			rjson = Array.new
			poiLocs = params[:pois]
			tweetLocs = params[:tweets]
			ratings = Array.new(64) { |i| Array.new(5) { |i| 0 }}
			watercolors = ["00FE00", "00FF00"]
			totPop, avgPop, totInc, avgInc, totWF, avgWF, totWFIN, avgWFIN, totWFOUT, avgWFOUT = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
		
			bboxes = getboxes(params[:center][0].to_f, params[:center][1].to_f)		
			poisInBB = Array.new(bboxes.length) { |i| 0 }
			tweetsInBB = Array.new(bboxes.length) { |i| 0 }
		
			bboxes.each { |x| bboxescentre.push(getcentre(x[0], x[1], x[2], x[3])) }
		
			bboxescentre.each { |x| bboxesccolors.push(getpointtype(x[0],x[1])) }
		
			bboxesccolors.each_with_index{ |x, i| 
				if(watercolors.include?(x[0].to_s[1..-1].upcase)) 
					bboxesccolors[i] = ['ignore']  
				end 
			}
				
			sAString = "["
			bboxescentre.each { |x| 
				sAString += '{"geometry":{"x":'+x[0].to_s+',"y":'+x[1].to_s+'}}, '
			}
			sAString = sAString.chomp(', ')+"]"
		
			if (!session[:token])
				session[:token] = getarctoken
			end
		
			enrich = Net::HTTP.post_form URI('http://geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer/Geoenrichment/enrich'),
			 f: 'json',
			 token: session[:token],
			 studyAreas: sAString,
			 analysisVariables: '["KeyGlobalFacts.TOTPOP", "HouseholdPopulationIncome.ECYPNIAVG", "LabourForceStatus.A11LFTT", "LabourForceStatus.A11LFTINLF"]'
		
			if(JSON.parse(enrich.body)["error"] && JSON.parse(enrich.body)["error"]["message"] == "Invalid Token")
				session[:token] = getarctoken
			end
		
			tdata = JSON.parse(enrich.body)["results"][0]["value"]["FeatureSet"][0]["features"]
			bboxes.each_with_index { |box, x| rjson.push([[box[0].to_s, box[1].to_s, box[2].to_s, box[3].to_s], [bboxescentre[x][0].to_s, bboxescentre[x][1].to_s], bboxesccolors[x], [tdata[x]["attributes"]["TOTPOP"], tdata[x]["attributes"]["ECYPNIAVG"], tdata[x]["attributes"]["A11LFTT"], tdata[x]["attributes"]["A11LFTINLF"]]]) }
		
			rjson.each { |x| 
				totPop += x[3][0]
				totInc += x[3][1] 
				totWF += x[3][2]
				totWFIN += x[3][3]
			}
		
			avgPop = totPop / rjson.length
			avgInc = totInc / rjson.length
			avgWF = totWF / rjson.length
			avgWFIN  = totWFIN / rjson.length
			totWFOUT = totWF - totWFIN
			avgWFOUT = totWFOUT / rjson.length
		
			dpoiLocs = poiLocs.dup
			dtweetLocs = tweetLocs.dup
			bboxes.each_with_index { |bbox, i| 
				count = 0
				while(count < dpoiLocs.length) do			
					if(checkIfPointInBB(bbox, dpoiLocs[count.to_s]))
						poisInBB[i] += 1
					end
					count += 1
				end
				count2 = 0
				while(count2 < dtweetLocs.length) do			
					if(checkIfPointInBB(bbox, dtweetLocs[count2.to_s]))
						tweetsInBB[i] += 1
					end				
					count2 += 1
				end
			}
		
			bboxes.each_with_index { |box, x| rjson2.push([[box[0].to_s, box[1].to_s, box[2].to_s, box[3].to_s], [bboxescentre[x][0].to_s, bboxescentre[x][1].to_s], bboxesccolors[x], [tdata[x]["attributes"]["TOTPOP"], tdata[x]["attributes"]["ECYPNIAVG"], tdata[x]["attributes"]["A11LFTT"], tdata[x]["attributes"]["A11LFTINLF"]], [avgPop, avgInc, avgWF, avgWFIN, avgWFOUT], [poisInBB[x], tweetsInBB[x]]]) }
		else 
			rjson2 = eval(params[:qtype])
		end
		
		#testArray = Array.new
		#testArray = [[["-89.35713452476227","-89.3334021435717","48.35828117115878","48.37403112836908"],["-89.34526833416699","48.36615614976393"],["#EFECE4"],[1662,49225.14,1380,832],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.35828117115878","48.37403112836908"],["-89.32153595297642","48.36615614976393"],["#E7E4DD"],[2548,42517.25,2086,1311],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.37403112836908","48.389781085579386"],["-89.34526833416699","48.381906106974235"],["#EEEBE4"],[1837,49630.96,1395,838],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.37403112836908","48.389781085579386"],["-89.32153595297642","48.381906106974235"],["#ECEAE5"],[3010,52001.48,2183,1381],[4176,41358.81453124999,3346,2048,1298],[3,1]],[["-89.30966976238113","-89.28593738119056","48.35828117115878","48.37403112836908"],["-89.29780357178585","48.36615614976393"],["#E7E3DC"],[6370,40407.86,5318,3221],[4176,41358.81453124999,3346,2048,1298],[6,6]],[["-89.28593738119056","-89.262205","48.35828117115878","48.37403112836908"],["-89.27407119059528","48.36615614976393"],["#E8E5DC"],[11455,41369.29,9550,6165],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.37403112836908","48.389781085579386"],["-89.29780357178585","48.381906106974235"],["#EBE8E1"],[11430,44408.94,9383,5508],[4176,41358.81453124999,3346,2048,1298],[3,1]],[["-89.28593738119056","-89.262205","48.37403112836908","48.389781085579386"],["-89.27407119059528","48.381906106974235"],["#E8E5DE"],[18301,43238.89,15038,9252],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.389781085579386","48.40553104278969"],["-89.34526833416699","48.39765606418454"],["#EFECE4"],[902,54344.17,654,413],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.389781085579386","48.40553104278969"],["-89.32153595297642","48.39765606418454"],["#EFECE4"],[2149,56892.75,1462,944],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.40553104278969","48.42128099999999"],["-89.34526833416699","48.41340602139484"],["#EFECE4"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.40553104278969","48.42128099999999"],["-89.32153595297642","48.41340602139484"],["#EFECE4"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.389781085579386","48.40553104278969"],["-89.29780357178585","48.39765606418454"],["#EEEAE0"],[9316,45710.71,7561,4580],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.389781085579386","48.40553104278969"],["-89.27407119059528","48.39765606418454"],["#E3E3D6"],[10431,42441.69,8505,5233],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.40553104278969","48.42128099999999"],["-89.29780357178585","48.41340602139484"],["#EFECE4"],[328,45827.12,251,163],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.40553104278969","48.42128099999999"],["-89.27407119059528","48.41340602139484"],["#D3DECF"],[1610,49897.64,1229,805],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.35828117115878","48.37403112836908"],["-89.25033880940471","48.36615614976393"],["#D8E0EF"],[6369,48096.81,5395,3678],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.35828117115878","48.37403112836908"],["-89.22660642821414","48.36615614976393"],["#EFECE4"],[33,31423.24,30,17],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.37403112836908","48.389781085579386"],["-89.25033880940471","48.381906106974235"],["#E9E5DE"],[14387,39475.47,11452,6917],[4176,41358.81453124999,3346,2048,1298],[3,3]],[["-89.23847261880942","-89.21474023761886","48.37403112836908","48.389781085579386"],["-89.22660642821414","48.381906106974235"],["#EDEAE3"],[3637,27701.17,2901,1486],[4176,41358.81453124999,3346,2048,1298],[3,2]],[["-89.21474023761886","-89.19100785642829","48.35828117115878","48.37403112836908"],["-89.20287404702357","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.35828117115878","48.37403112836908"],["-89.17914166583299","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.37403112836908","48.389781085579386"],["-89.20287404702357","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.37403112836908","48.389781085579386"],["-89.17914166583299","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.389781085579386","48.40553104278969"],["-89.25033880940471","48.39765606418454"],["#EAE7DF"],[8875,32757.15,7069,4062],[4176,41358.81453124999,3346,2048,1298],[6,4]],[["-89.23847261880942","-89.21474023761886","48.389781085579386","48.40553104278969"],["-89.22660642821414","48.39765606418454"],["#DCD9D5"],[4724,33104.39,3949,2255],[4176,41358.81453124999,3346,2048,1298],[3,1]],[["-89.262205","-89.23847261880942","48.40553104278969","48.42128099999999"],["-89.25033880940471","48.41340602139484"],["#EDEBE4"],[4182,31348.49,3108,1641],[4176,41358.81453124999,3346,2048,1298],[10,5]],[["-89.23847261880942","-89.21474023761886","48.40553104278969","48.42128099999999"],["-89.22660642821414","48.41340602139484"],["#DFE1E3"],[757,36074.37,629,380],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.389781085579386","48.40553104278969"],["-89.20287404702357","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.389781085579386","48.40553104278969"],["-89.17914166583299","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.40553104278969","48.42128099999999"],["-89.20287404702357","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.40553104278969","48.42128099999999"],["-89.17914166583299","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.42128099999999","48.4370309572103"],["-89.34526833416699","48.429155978605145"],["#EFECE4"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.42128099999999","48.4370309572103"],["-89.32153595297642","48.429155978605145"],["#EFECE4"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.4370309572103","48.4527809144206"],["-89.34526833416699","48.44490593581545"],["#EFECE4"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.4370309572103","48.4527809144206"],["-89.32153595297642","48.44490593581545"],["#EFECE5"],[132,70183.73,94,67],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.42128099999999","48.4370309572103"],["-89.29780357178585","48.429155978605145"],["#EDEAE2"],[730,63729.97,558,325],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.42128099999999","48.4370309572103"],["-89.27407119059528","48.429155978605145"],["#EBE8E2"],[5338,61845.64,3410,2461],[4176,41358.81453124999,3346,2048,1298],[1,2]],[["-89.30966976238113","-89.28593738119056","48.4370309572103","48.4527809144206"],["-89.29780357178585","48.44490593581545"],["#EDEBE5"],[1962,64035.65,1229,914],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.4370309572103","48.4527809144206"],["-89.27407119059528","48.44490593581545"],["#EEEBE4"],[10808,55660.11,7858,4977],[4176,41358.81453124999,3346,2048,1298],[4,3]],[["-89.35713452476227","-89.3334021435717","48.4527809144206","48.468530871630904"],["-89.34526833416699","48.46065589302575"],["#EFECE4"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.4527809144206","48.468530871630904"],["-89.32153595297642","48.46065589302575"],["#EFECE4"],[469,64615.63,303,224],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.468530871630904","48.484280828841214"],["-89.34526833416699","48.47640585023606"],["#ECEAE6"],[256,52695,188,136],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.468530871630904","48.484280828841214"],["-89.32153595297642","48.47640585023606"],["#EDEBE5"],[598,54455.51,412,260],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.4527809144206","48.468530871630904"],["-89.29780357178585","48.46065589302575"],["#EFECE4"],[1371,62414.49,853,638],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.28593738119056","-89.262205","48.4527809144206","48.468530871630904"],["-89.27407119059528","48.46065589302575"],["#EEEBE4"],[6196,57416.49,4413,2852],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.30966976238113","-89.28593738119056","48.468530871630904","48.484280828841214"],["-89.29780357178585","48.47640585023606"],["#EFECE4"],[448,51855.02,324,189],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.468530871630904","48.484280828841214"],["-89.27407119059528","48.47640585023606"],["#EFECE4"],[615,55020.39,427,294],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.42128099999999","48.4370309572103"],["-89.25033880940471","48.429155978605145"],["#E6E2DB"],[15747,42483.45,12285,7224],[4176,41358.81453124999,3346,2048,1298],[3,3]],[["-89.23847261880942","-89.21474023761886","48.42128099999999","48.4370309572103"],["-89.22660642821414","48.429155978605145"],["#E9E6E0"],[10675,40606.48,9116,5307],[4176,41358.81453124999,3346,2048,1298],[3,1]],[["-89.262205","-89.23847261880942","48.4370309572103","48.4527809144206"],["-89.25033880940471","48.44490593581545"],["#ECE8E1"],[17501,44749.3,14520,8603],[4176,41358.81453124999,3346,2048,1298],[4,8]],[["-89.23847261880942","-89.21474023761886","48.4370309572103","48.4527809144206"],["-89.22660642821414","48.44490593581545"],["#E6E3DC"],[18112,43544.06,15446,9436],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.42128099999999","48.4370309572103"],["-89.20287404702357","48.429155978605145"],["ignore"],[891,34498.07,737,441],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.42128099999999","48.4370309572103"],["-89.17914166583299","48.429155978605145"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4370309572103","48.4527809144206"],["-89.20287404702357","48.44490593581545"],["#E8E6DF"],[7038,43760,5694,3410],[4176,41358.81453124999,3346,2048,1298],[3,3]],[["-89.19100785642829","-89.1672754752377","48.4370309572103","48.4527809144206"],["-89.17914166583299","48.44490593581545"],["ignore"],[935,37085.57,775,451],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.4527809144206","48.468530871630904"],["-89.25033880940471","48.46065589302575"],["#E8E5DD"],[9648,45345.54,7581,4718],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.4527809144206","48.468530871630904"],["-89.22660642821414","48.46065589302575"],["#EDE8DC"],[10694,42476.86,8866,5488],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.468530871630904","48.484280828841214"],["-89.25033880940471","48.47640585023606"],["#EFECE4"],[905,51724.01,622,447],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.468530871630904","48.484280828841214"],["-89.22660642821414","48.47640585023606"],["#ECE9E2"],[350,44504.75,243,174],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4527809144206","48.468530871630904"],["-89.20287404702357","48.46065589302575"],["#E2E4E7"],[9238,42276.86,7486,4508],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.4527809144206","48.468530871630904"],["-89.17914166583299","48.46065589302575"],["#EEEBE3"],[4269,38992.35,3639,2286],[4176,41358.81453124999,3346,2048,1298],[3,3]],[["-89.21474023761886","-89.19100785642829","48.468530871630904","48.484280828841214"],["-89.20287404702357","48.47640585023606"],["#F0EBDE"],[2349,43171.04,1988,1192],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.468530871630904","48.484280828841214"],["-89.17914166583299","48.47640585023606"],["#EFECE4"],[2967,40688.62,2603,1632],[4176,41358.81453124999,3346,2048,1298],[0,2]]]
		#gas station = [[["-89.35713452476227","-89.3334021435717","48.35828117115878","48.37403112836908"],["-89.34526833416699","48.36615614976393"],["ignore"],[1662,49225.14,1380,832],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.35828117115878","48.37403112836908"],["-89.32153595297642","48.36615614976393"],["ignore"],[2548,42517.25,2086,1311],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.37403112836908","48.389781085579386"],["-89.34526833416699","48.381906106974235"],["ignore"],[1837,49630.96,1395,838],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.37403112836908","48.389781085579386"],["-89.32153595297642","48.381906106974235"],["ignore"],[3010,52001.48,2183,1381],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.35828117115878","48.37403112836908"],["-89.29780357178585","48.36615614976393"],["ignore"],[6370,40407.86,5318,3221],[4176,41358.81453124999,3346,2048,1298],[4,3]],[["-89.28593738119056","-89.262205","48.35828117115878","48.37403112836908"],["-89.27407119059528","48.36615614976393"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[11455,41369.29,9550,6165],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.37403112836908","48.389781085579386"],["-89.29780357178585","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[11430,44408.94,9383,5508],[4176,41358.81453124999,3346,2048,1298],[4,3]],[["-89.28593738119056","-89.262205","48.37403112836908","48.389781085579386"],["-89.27407119059528","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[18301,43238.89,15038,9252],[4176,41358.81453124999,3346,2048,1298],[5,2]],[["-89.35713452476227","-89.3334021435717","48.389781085579386","48.40553104278969"],["-89.34526833416699","48.39765606418454"],["ignore"],[902,54344.17,654,413],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.389781085579386","48.40553104278969"],["-89.32153595297642","48.39765606418454"],["ignore"],[2149,56892.75,1462,944],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.40553104278969","48.42128099999999"],["-89.34526833416699","48.41340602139484"],["ignore"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.40553104278969","48.42128099999999"],["-89.32153595297642","48.41340602139484"],["ignore"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.389781085579386","48.40553104278969"],["-89.29780357178585","48.39765606418454"],["ignore"],[9316,45710.71,7561,4580],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.389781085579386","48.40553104278969"],["-89.27407119059528","48.39765606418454"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10431,42441.69,8505,5233],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.40553104278969","48.42128099999999"],["-89.29780357178585","48.41340602139484"],["ignore"],[328,45827.12,251,163],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.40553104278969","48.42128099999999"],["-89.27407119059528","48.41340602139484"],["ignore"],[1610,49897.64,1229,805],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.35828117115878","48.37403112836908"],["-89.25033880940471","48.36615614976393"],["ignore"],[6369,48096.81,5395,3678],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.35828117115878","48.37403112836908"],["-89.22660642821414","48.36615614976393"],["ignore"],[33,31423.24,30,17],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.37403112836908","48.389781085579386"],["-89.25033880940471","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[14387,39475.47,11452,6917],[4176,41358.81453124999,3346,2048,1298],[2,3]],[["-89.23847261880942","-89.21474023761886","48.37403112836908","48.389781085579386"],["-89.22660642821414","48.381906106974235"],["ignore"],[3637,27701.17,2901,1486],[4176,41358.81453124999,3346,2048,1298],[1,1]],[["-89.21474023761886","-89.19100785642829","48.35828117115878","48.37403112836908"],["-89.20287404702357","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.35828117115878","48.37403112836908"],["-89.17914166583299","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.37403112836908","48.389781085579386"],["-89.20287404702357","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.37403112836908","48.389781085579386"],["-89.17914166583299","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.389781085579386","48.40553104278969"],["-89.25033880940471","48.39765606418454"],["ignore"],[8875,32757.15,7069,4062],[4176,41358.81453124999,3346,2048,1298],[2,2]],[["-89.23847261880942","-89.21474023761886","48.389781085579386","48.40553104278969"],["-89.22660642821414","48.39765606418454"],["ignore"],[4724,33104.39,3949,2255],[4176,41358.81453124999,3346,2048,1298],[1,2]],[["-89.262205","-89.23847261880942","48.40553104278969","48.42128099999999"],["-89.25033880940471","48.41340602139484"],["ignore"],[4182,31348.49,3108,1641],[4176,41358.81453124999,3346,2048,1298],[3,4]],[["-89.23847261880942","-89.21474023761886","48.40553104278969","48.42128099999999"],["-89.22660642821414","48.41340602139484"],["ignore"],[757,36074.37,629,380],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.389781085579386","48.40553104278969"],["-89.20287404702357","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.389781085579386","48.40553104278969"],["-89.17914166583299","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.40553104278969","48.42128099999999"],["-89.20287404702357","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.40553104278969","48.42128099999999"],["-89.17914166583299","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.42128099999999","48.4370309572103"],["-89.34526833416699","48.429155978605145"],["ignore"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.42128099999999","48.4370309572103"],["-89.32153595297642","48.429155978605145"],["ignore"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.4370309572103","48.4527809144206"],["-89.34526833416699","48.44490593581545"],["ignore"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.3334021435717","-89.30966976238113","48.4370309572103","48.4527809144206"],["-89.32153595297642","48.44490593581545"],["ignore"],[132,70183.73,94,67],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.42128099999999","48.4370309572103"],["-89.29780357178585","48.429155978605145"],["ignore"],[730,63729.97,558,325],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.28593738119056","-89.262205","48.42128099999999","48.4370309572103"],["-89.27407119059528","48.429155978605145"],["ignore"],[5338,61845.64,3410,2461],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.4370309572103","48.4527809144206"],["-89.29780357178585","48.44490593581545"],["ignore"],[1962,64035.65,1229,914],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.4370309572103","48.4527809144206"],["-89.27407119059528","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10808,55660.11,7858,4977],[4176,41358.81453124999,3346,2048,1298],[2,4]],[["-89.35713452476227","-89.3334021435717","48.4527809144206","48.468530871630904"],["-89.34526833416699","48.46065589302575"],["ignore"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.4527809144206","48.468530871630904"],["-89.32153595297642","48.46065589302575"],["ignore"],[469,64615.63,303,224],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.468530871630904","48.484280828841214"],["-89.34526833416699","48.47640585023606"],["ignore"],[256,52695,188,136],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.468530871630904","48.484280828841214"],["-89.32153595297642","48.47640585023606"],["ignore"],[598,54455.51,412,260],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.4527809144206","48.468530871630904"],["-89.29780357178585","48.46065589302575"],["ignore"],[1371,62414.49,853,638],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.4527809144206","48.468530871630904"],["-89.27407119059528","48.46065589302575"],["ignore"],[6196,57416.49,4413,2852],[4176,41358.81453124999,3346,2048,1298],[1,3]],[["-89.30966976238113","-89.28593738119056","48.468530871630904","48.484280828841214"],["-89.29780357178585","48.47640585023606"],["ignore"],[448,51855.02,324,189],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.468530871630904","48.484280828841214"],["-89.27407119059528","48.47640585023606"],["ignore"],[615,55020.39,427,294],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.42128099999999","48.4370309572103"],["-89.25033880940471","48.429155978605145"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[15747,42483.45,12285,7224],[4176,41358.81453124999,3346,2048,1298],[3,3]],[["-89.23847261880942","-89.21474023761886","48.42128099999999","48.4370309572103"],["-89.22660642821414","48.429155978605145"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10675,40606.48,9116,5307],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.4370309572103","48.4527809144206"],["-89.25033880940471","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[17501,44749.3,14520,8603],[4176,41358.81453124999,3346,2048,1298],[3,1]],[["-89.23847261880942","-89.21474023761886","48.4370309572103","48.4527809144206"],["-89.22660642821414","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[18112,43544.06,15446,9436],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.42128099999999","48.4370309572103"],["-89.20287404702357","48.429155978605145"],["ignore"],[891,34498.07,737,441],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.42128099999999","48.4370309572103"],["-89.17914166583299","48.429155978605145"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4370309572103","48.4527809144206"],["-89.20287404702357","48.44490593581545"],["ignore"],[7038,43760,5694,3410],[4176,41358.81453124999,3346,2048,1298],[4,3]],[["-89.19100785642829","-89.1672754752377","48.4370309572103","48.4527809144206"],["-89.17914166583299","48.44490593581545"],["ignore"],[935,37085.57,775,451],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.4527809144206","48.468530871630904"],["-89.25033880940471","48.46065589302575"],["ignore"],[9648,45345.54,7581,4718],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.4527809144206","48.468530871630904"],["-89.22660642821414","48.46065589302575"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10694,42476.86,8866,5488],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.468530871630904","48.484280828841214"],["-89.25033880940471","48.47640585023606"],["ignore"],[905,51724.01,622,447],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.468530871630904","48.484280828841214"],["-89.22660642821414","48.47640585023606"],["ignore"],[350,44504.75,243,174],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4527809144206","48.468530871630904"],["-89.20287404702357","48.46065589302575"],["ignore"],[9238,42276.86,7486,4508],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.4527809144206","48.468530871630904"],["-89.17914166583299","48.46065589302575"],["ignore"],[4269,38992.35,3639,2286],[4176,41358.81453124999,3346,2048,1298],[6,5]],[["-89.21474023761886","-89.19100785642829","48.468530871630904","48.484280828841214"],["-89.20287404702357","48.47640585023606"],["ignore"],[2349,43171.04,1988,1192],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.468530871630904","48.484280828841214"],["-89.17914166583299","48.47640585023606"],["ignore"],[2967,40688.62,2603,1632],[4176,41358.81453124999,3346,2048,1298],[0,0]]]
		#grocery store = [[["-89.35713452476227","-89.3334021435717","48.35828117115878","48.37403112836908"],["-89.34526833416699","48.36615614976393"],["ignore"],[1662,49225.14,1380,832],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.35828117115878","48.37403112836908"],["-89.32153595297642","48.36615614976393"],["ignore"],[2548,42517.25,2086,1311],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.35713452476227","-89.3334021435717","48.37403112836908","48.389781085579386"],["-89.34526833416699","48.381906106974235"],["ignore"],[1837,49630.96,1395,838],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.37403112836908","48.389781085579386"],["-89.32153595297642","48.381906106974235"],["ignore"],[3010,52001.48,2183,1381],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.35828117115878","48.37403112836908"],["-89.29780357178585","48.36615614976393"],["ignore"],[6370,40407.86,5318,3221],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.35828117115878","48.37403112836908"],["-89.27407119059528","48.36615614976393"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[11455,41369.29,9550,6165],[4176,41358.81453124999,3346,2048,1298],[2,4]],[["-89.30966976238113","-89.28593738119056","48.37403112836908","48.389781085579386"],["-89.29780357178585","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[11430,44408.94,9383,5508],[4176,41358.81453124999,3346,2048,1298],[3,4]],[["-89.28593738119056","-89.262205","48.37403112836908","48.389781085579386"],["-89.27407119059528","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[18301,43238.89,15038,9252],[4176,41358.81453124999,3346,2048,1298],[2,5]],[["-89.35713452476227","-89.3334021435717","48.389781085579386","48.40553104278969"],["-89.34526833416699","48.39765606418454"],["ignore"],[902,54344.17,654,413],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.3334021435717","-89.30966976238113","48.389781085579386","48.40553104278969"],["-89.32153595297642","48.39765606418454"],["ignore"],[2149,56892.75,1462,944],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.40553104278969","48.42128099999999"],["-89.34526833416699","48.41340602139484"],["ignore"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.40553104278969","48.42128099999999"],["-89.32153595297642","48.41340602139484"],["ignore"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.389781085579386","48.40553104278969"],["-89.29780357178585","48.39765606418454"],["ignore"],[9316,45710.71,7561,4580],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.389781085579386","48.40553104278969"],["-89.27407119059528","48.39765606418454"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10431,42441.69,8505,5233],[4176,41358.81453124999,3346,2048,1298],[2,2]],[["-89.30966976238113","-89.28593738119056","48.40553104278969","48.42128099999999"],["-89.29780357178585","48.41340602139484"],["ignore"],[328,45827.12,251,163],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.40553104278969","48.42128099999999"],["-89.27407119059528","48.41340602139484"],["ignore"],[1610,49897.64,1229,805],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.35828117115878","48.37403112836908"],["-89.25033880940471","48.36615614976393"],["ignore"],[6369,48096.81,5395,3678],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.35828117115878","48.37403112836908"],["-89.22660642821414","48.36615614976393"],["ignore"],[33,31423.24,30,17],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.37403112836908","48.389781085579386"],["-89.25033880940471","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[14387,39475.47,11452,6917],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.37403112836908","48.389781085579386"],["-89.22660642821414","48.381906106974235"],["ignore"],[3637,27701.17,2901,1486],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.35828117115878","48.37403112836908"],["-89.20287404702357","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.35828117115878","48.37403112836908"],["-89.17914166583299","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.37403112836908","48.389781085579386"],["-89.20287404702357","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.37403112836908","48.389781085579386"],["-89.17914166583299","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.389781085579386","48.40553104278969"],["-89.25033880940471","48.39765606418454"],["ignore"],[8875,32757.15,7069,4062],[4176,41358.81453124999,3346,2048,1298],[3,3]],[["-89.23847261880942","-89.21474023761886","48.389781085579386","48.40553104278969"],["-89.22660642821414","48.39765606418454"],["ignore"],[4724,33104.39,3949,2255],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.40553104278969","48.42128099999999"],["-89.25033880940471","48.41340602139484"],["ignore"],[4182,31348.49,3108,1641],[4176,41358.81453124999,3346,2048,1298],[4,4]],[["-89.23847261880942","-89.21474023761886","48.40553104278969","48.42128099999999"],["-89.22660642821414","48.41340602139484"],["ignore"],[757,36074.37,629,380],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.389781085579386","48.40553104278969"],["-89.20287404702357","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.389781085579386","48.40553104278969"],["-89.17914166583299","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.40553104278969","48.42128099999999"],["-89.20287404702357","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.40553104278969","48.42128099999999"],["-89.17914166583299","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.42128099999999","48.4370309572103"],["-89.34526833416699","48.429155978605145"],["ignore"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.42128099999999","48.4370309572103"],["-89.32153595297642","48.429155978605145"],["ignore"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.4370309572103","48.4527809144206"],["-89.34526833416699","48.44490593581545"],["ignore"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.4370309572103","48.4527809144206"],["-89.32153595297642","48.44490593581545"],["ignore"],[132,70183.73,94,67],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.42128099999999","48.4370309572103"],["-89.29780357178585","48.429155978605145"],["ignore"],[730,63729.97,558,325],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.42128099999999","48.4370309572103"],["-89.27407119059528","48.429155978605145"],["ignore"],[5338,61845.64,3410,2461],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.4370309572103","48.4527809144206"],["-89.29780357178585","48.44490593581545"],["ignore"],[1962,64035.65,1229,914],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.4370309572103","48.4527809144206"],["-89.27407119059528","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10808,55660.11,7858,4977],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.35713452476227","-89.3334021435717","48.4527809144206","48.468530871630904"],["-89.34526833416699","48.46065589302575"],["ignore"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.4527809144206","48.468530871630904"],["-89.32153595297642","48.46065589302575"],["ignore"],[469,64615.63,303,224],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.468530871630904","48.484280828841214"],["-89.34526833416699","48.47640585023606"],["ignore"],[256,52695,188,136],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.468530871630904","48.484280828841214"],["-89.32153595297642","48.47640585023606"],["ignore"],[598,54455.51,412,260],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.4527809144206","48.468530871630904"],["-89.29780357178585","48.46065589302575"],["ignore"],[1371,62414.49,853,638],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.4527809144206","48.468530871630904"],["-89.27407119059528","48.46065589302575"],["ignore"],[6196,57416.49,4413,2852],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.468530871630904","48.484280828841214"],["-89.29780357178585","48.47640585023606"],["ignore"],[448,51855.02,324,189],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.468530871630904","48.484280828841214"],["-89.27407119059528","48.47640585023606"],["ignore"],[615,55020.39,427,294],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.262205","-89.23847261880942","48.42128099999999","48.4370309572103"],["-89.25033880940471","48.429155978605145"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[15747,42483.45,12285,7224],[4176,41358.81453124999,3346,2048,1298],[2,4]],[["-89.23847261880942","-89.21474023761886","48.42128099999999","48.4370309572103"],["-89.22660642821414","48.429155978605145"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[10675,40606.48,9116,5307],[4176,41358.81453124999,3346,2048,1298],[5,10]],[["-89.262205","-89.23847261880942","48.4370309572103","48.4527809144206"],["-89.25033880940471","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[17501,44749.3,14520,8603],[4176,41358.81453124999,3346,2048,1298],[4,3]],[["-89.23847261880942","-89.21474023761886","48.4370309572103","48.4527809144206"],["-89.22660642821414","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[18112,43544.06,15446,9436],[4176,41358.81453124999,3346,2048,1298],[5,8]],[["-89.21474023761886","-89.19100785642829","48.42128099999999","48.4370309572103"],["-89.20287404702357","48.429155978605145"],["ignore"],[891,34498.07,737,441],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.42128099999999","48.4370309572103"],["-89.17914166583299","48.429155978605145"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4370309572103","48.4527809144206"],["-89.20287404702357","48.44490593581545"],["ignore"],[7038,43760,5694,3410],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.4370309572103","48.4527809144206"],["-89.17914166583299","48.44490593581545"],["ignore"],[935,37085.57,775,451],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.4527809144206","48.468530871630904"],["-89.25033880940471","48.46065589302575"],["ignore"],[9648,45345.54,7581,4718],[4176,41358.81453124999,3346,2048,1298],[1,0]],[["-89.23847261880942","-89.21474023761886","48.4527809144206","48.468530871630904"],["-89.22660642821414","48.46065589302575"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10694,42476.86,8866,5488],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.468530871630904","48.484280828841214"],["-89.25033880940471","48.47640585023606"],["ignore"],[905,51724.01,622,447],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.23847261880942","-89.21474023761886","48.468530871630904","48.484280828841214"],["-89.22660642821414","48.47640585023606"],["ignore"],[350,44504.75,243,174],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4527809144206","48.468530871630904"],["-89.20287404702357","48.46065589302575"],["ignore"],[9238,42276.86,7486,4508],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.4527809144206","48.468530871630904"],["-89.17914166583299","48.46065589302575"],["ignore"],[4269,38992.35,3639,2286],[4176,41358.81453124999,3346,2048,1298],[1,2]],[["-89.21474023761886","-89.19100785642829","48.468530871630904","48.484280828841214"],["-89.20287404702357","48.47640585023606"],["ignore"],[2349,43171.04,1988,1192],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.468530871630904","48.484280828841214"],["-89.17914166583299","48.47640585023606"],["ignore"],[2967,40688.62,2603,1632],[4176,41358.81453124999,3346,2048,1298],[2,6]]]
		count = 0
		#Filter output
		rjson2.each_with_index { |box, i| 
			next if(rjson2[i][2][0] == "ignore") 
			#check for population
			tcnt = 0
			rating = 0
			while(tcnt < 10) 
				if(box[3][0].to_i < (params[:filters][0].to_i + (tcnt*params[:filters][0].to_i)) && box[5][0] <= tcnt)
					rjson2[i][2][0] = "ignore"
				end
				tcnt += 1
			end
			next if(rjson2[i][2][0] == "ignore") 
			#calculate location ratings			
			##cost rating of locality
			locPric = (box[3][1]/box[4][1]) * 100
			if(locPric.to_i >= 95 && locPric.to_i <= 105)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 3
			elsif(locPric.to_i >= 80 && locPric.to_i <= 94)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating  = 2
			elsif(locPric.to_i >= 106 && locPric.to_i <= 120)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating  = 4
			elsif(locPric.to_i <= 79)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 1
			elsif(locPric.to_i >= 121)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating  = 5
			end
			
			ratings[i][0] = rating
			ratings[i][4] += rating
			if(params[:filters][1].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
			
			next if(rjson2[i][2][0] == "ignore")
			
			##crime rating of locality
			locCrim = ((box[3][3].to_f/(box[3][2].to_f - box[3][3].to_f)) * 100 - 100).to_i
			avgCrim = ((box[4][3].to_f/(box[4][4].to_f)) * 100 - 100).to_i
			crimeRat = (locCrim.to_f/avgCrim.to_f) * 100
			rating = 0
			if(crimeRat.to_i >= 90 && crimeRat.to_i <= 110)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 3
			elsif(crimeRat.to_i >= 111 && crimeRat.to_i <= 130)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating  = 2
			elsif(crimeRat.to_i >= 70 && crimeRat.to_i <= 89)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating  = 4
			elsif(crimeRat.to_i >= 131)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 1
			elsif(crimeRat.to_i <= 69)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating  = 5
			end
			
			ratings[i][1] = rating
			ratings[i][4] -= rating
			if(params[:filters][2].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
			
		}
		
		totTweets = 0
		actBbox = 0
		totComt = 0
		rjson2.each_with_index{ |box1, j| 
			if(rjson2[j][2][0] != "ignore") 
				totTweets += box1[5][1]
				totComt += box1[5][0]
				actBbox += 1
			end
		}
		avgATwts =  totTweets / actBbox
		rjson2.each_with_index { |box, i| 
			next if(rjson2[i][2][0] == "ignore") 	
			##social rating of locality
			cbbtwts = box[5][1]
			twtRat = 0
			rating = 0
			if(avgATwts != 0)
				twtRat = (box[5][1] - avgATwts)/avgATwts
			end
			
			if(twtRat == 1)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 3
			elsif(twtRat == 0)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating  = 2
			elsif(twtRat == 2)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating  = 4
			elsif(twtRat < 0)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 1
			elsif(twtRat > 2)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating  = 5
			end
			
			ratings[i][2] = rating
			ratings[i][4] += rating
			if(params[:filters][3].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
			
			next if(rjson2[i][2][0] == "ignore")
			
			##social rating of locality
			cbbComt = box[5][0]
			rating = 0
			if(cbbComt == 2)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating = 3
			elsif(cbbComt == 1)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating = 2
			elsif(cbbComt == 3)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating = 4
			elsif(cbbComt == 0)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating = 1
			elsif(cbbComt >= 4)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating = 5
			end
			
			ratings[i][3] = rating
			ratings[i][4] += rating
			if(params[:filters][4].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
		}
		
		rjson2.each_with_index{ |box, i| box.push(ratings[i]) }
		
		render :json => rjson2
	end
	
	def api
		ratings = Array.new(64) { |i| Array.new(5) { |i| 0 }}
		rjson2 = [[["-89.35713452476227","-89.3334021435717","48.35828117115878","48.37403112836908"],["-89.34526833416699","48.36615614976393"],["ignore"],[1662,49225.14,1380,832],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.35828117115878","48.37403112836908"],["-89.32153595297642","48.36615614976393"],["ignore"],[2548,42517.25,2086,1311],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.35713452476227","-89.3334021435717","48.37403112836908","48.389781085579386"],["-89.34526833416699","48.381906106974235"],["ignore"],[1837,49630.96,1395,838],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.37403112836908","48.389781085579386"],["-89.32153595297642","48.381906106974235"],["ignore"],[3010,52001.48,2183,1381],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.35828117115878","48.37403112836908"],["-89.29780357178585","48.36615614976393"],["ignore"],[6370,40407.86,5318,3221],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.35828117115878","48.37403112836908"],["-89.27407119059528","48.36615614976393"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[11455,41369.29,9550,6165],[4176,41358.81453124999,3346,2048,1298],[2,4]],[["-89.30966976238113","-89.28593738119056","48.37403112836908","48.389781085579386"],["-89.29780357178585","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[11430,44408.94,9383,5508],[4176,41358.81453124999,3346,2048,1298],[3,4]],[["-89.28593738119056","-89.262205","48.37403112836908","48.389781085579386"],["-89.27407119059528","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[18301,43238.89,15038,9252],[4176,41358.81453124999,3346,2048,1298],[2,5]],[["-89.35713452476227","-89.3334021435717","48.389781085579386","48.40553104278969"],["-89.34526833416699","48.39765606418454"],["ignore"],[902,54344.17,654,413],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.3334021435717","-89.30966976238113","48.389781085579386","48.40553104278969"],["-89.32153595297642","48.39765606418454"],["ignore"],[2149,56892.75,1462,944],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.40553104278969","48.42128099999999"],["-89.34526833416699","48.41340602139484"],["ignore"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.40553104278969","48.42128099999999"],["-89.32153595297642","48.41340602139484"],["ignore"],[507,56634.36,371,216],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.389781085579386","48.40553104278969"],["-89.29780357178585","48.39765606418454"],["ignore"],[9316,45710.71,7561,4580],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.389781085579386","48.40553104278969"],["-89.27407119059528","48.39765606418454"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10431,42441.69,8505,5233],[4176,41358.81453124999,3346,2048,1298],[2,2]],[["-89.30966976238113","-89.28593738119056","48.40553104278969","48.42128099999999"],["-89.29780357178585","48.41340602139484"],["ignore"],[328,45827.12,251,163],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.40553104278969","48.42128099999999"],["-89.27407119059528","48.41340602139484"],["ignore"],[1610,49897.64,1229,805],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.35828117115878","48.37403112836908"],["-89.25033880940471","48.36615614976393"],["ignore"],[6369,48096.81,5395,3678],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.35828117115878","48.37403112836908"],["-89.22660642821414","48.36615614976393"],["ignore"],[33,31423.24,30,17],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.37403112836908","48.389781085579386"],["-89.25033880940471","48.381906106974235"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[14387,39475.47,11452,6917],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.23847261880942","-89.21474023761886","48.37403112836908","48.389781085579386"],["-89.22660642821414","48.381906106974235"],["ignore"],[3637,27701.17,2901,1486],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.35828117115878","48.37403112836908"],["-89.20287404702357","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.35828117115878","48.37403112836908"],["-89.17914166583299","48.36615614976393"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.37403112836908","48.389781085579386"],["-89.20287404702357","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.37403112836908","48.389781085579386"],["-89.17914166583299","48.381906106974235"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.389781085579386","48.40553104278969"],["-89.25033880940471","48.39765606418454"],["ignore"],[8875,32757.15,7069,4062],[4176,41358.81453124999,3346,2048,1298],[3,3]],[["-89.23847261880942","-89.21474023761886","48.389781085579386","48.40553104278969"],["-89.22660642821414","48.39765606418454"],["ignore"],[4724,33104.39,3949,2255],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.40553104278969","48.42128099999999"],["-89.25033880940471","48.41340602139484"],["ignore"],[4182,31348.49,3108,1641],[4176,41358.81453124999,3346,2048,1298],[4,4]],[["-89.23847261880942","-89.21474023761886","48.40553104278969","48.42128099999999"],["-89.22660642821414","48.41340602139484"],["ignore"],[757,36074.37,629,380],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.389781085579386","48.40553104278969"],["-89.20287404702357","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.389781085579386","48.40553104278969"],["-89.17914166583299","48.39765606418454"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.40553104278969","48.42128099999999"],["-89.20287404702357","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.40553104278969","48.42128099999999"],["-89.17914166583299","48.41340602139484"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.42128099999999","48.4370309572103"],["-89.34526833416699","48.429155978605145"],["ignore"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.42128099999999","48.4370309572103"],["-89.32153595297642","48.429155978605145"],["ignore"],[486,70229.11,347,248],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.4370309572103","48.4527809144206"],["-89.34526833416699","48.44490593581545"],["ignore"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.4370309572103","48.4527809144206"],["-89.32153595297642","48.44490593581545"],["ignore"],[132,70183.73,94,67],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.42128099999999","48.4370309572103"],["-89.29780357178585","48.429155978605145"],["ignore"],[730,63729.97,558,325],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.42128099999999","48.4370309572103"],["-89.27407119059528","48.429155978605145"],["ignore"],[5338,61845.64,3410,2461],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.4370309572103","48.4527809144206"],["-89.29780357178585","48.44490593581545"],["ignore"],[1962,64035.65,1229,914],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.4370309572103","48.4527809144206"],["-89.27407119059528","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10808,55660.11,7858,4977],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.35713452476227","-89.3334021435717","48.4527809144206","48.468530871630904"],["-89.34526833416699","48.46065589302575"],["ignore"],[384,52753.81,282,204],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.4527809144206","48.468530871630904"],["-89.32153595297642","48.46065589302575"],["ignore"],[469,64615.63,303,224],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.35713452476227","-89.3334021435717","48.468530871630904","48.484280828841214"],["-89.34526833416699","48.47640585023606"],["ignore"],[256,52695,188,136],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.3334021435717","-89.30966976238113","48.468530871630904","48.484280828841214"],["-89.32153595297642","48.47640585023606"],["ignore"],[598,54455.51,412,260],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.4527809144206","48.468530871630904"],["-89.29780357178585","48.46065589302575"],["ignore"],[1371,62414.49,853,638],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.4527809144206","48.468530871630904"],["-89.27407119059528","48.46065589302575"],["ignore"],[6196,57416.49,4413,2852],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.30966976238113","-89.28593738119056","48.468530871630904","48.484280828841214"],["-89.29780357178585","48.47640585023606"],["ignore"],[448,51855.02,324,189],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.28593738119056","-89.262205","48.468530871630904","48.484280828841214"],["-89.27407119059528","48.47640585023606"],["ignore"],[615,55020.39,427,294],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.262205","-89.23847261880942","48.42128099999999","48.4370309572103"],["-89.25033880940471","48.429155978605145"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[15747,42483.45,12285,7224],[4176,41358.81453124999,3346,2048,1298],[2,4]],[["-89.23847261880942","-89.21474023761886","48.42128099999999","48.4370309572103"],["-89.22660642821414","48.429155978605145"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[10675,40606.48,9116,5307],[4176,41358.81453124999,3346,2048,1298],[5,10]],[["-89.262205","-89.23847261880942","48.4370309572103","48.4527809144206"],["-89.25033880940471","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[17501,44749.3,14520,8603],[4176,41358.81453124999,3346,2048,1298],[4,3]],[["-89.23847261880942","-89.21474023761886","48.4370309572103","48.4527809144206"],["-89.22660642821414","48.44490593581545"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003c/div\u003e"],[18112,43544.06,15446,9436],[4176,41358.81453124999,3346,2048,1298],[5,8]],[["-89.21474023761886","-89.19100785642829","48.42128099999999","48.4370309572103"],["-89.20287404702357","48.429155978605145"],["ignore"],[891,34498.07,737,441],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.42128099999999","48.4370309572103"],["-89.17914166583299","48.429155978605145"],["ignore"],[0,0,0,0],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4370309572103","48.4527809144206"],["-89.20287404702357","48.44490593581545"],["ignore"],[7038,43760,5694,3410],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.4370309572103","48.4527809144206"],["-89.17914166583299","48.44490593581545"],["ignore"],[935,37085.57,775,451],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.4527809144206","48.468530871630904"],["-89.25033880940471","48.46065589302575"],["ignore"],[9648,45345.54,7581,4718],[4176,41358.81453124999,3346,2048,1298],[1,0]],[["-89.23847261880942","-89.21474023761886","48.4527809144206","48.468530871630904"],["-89.22660642821414","48.46065589302575"],["\u003cdiv class='rating-title'\u003eCost Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCrime Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-half-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eSocial Rating:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e\u003c/br\u003e\u003cdiv class='rating-title'\u003eCompetition:\u003c/div\u003e \u003cdiv class='rating-rating'\u003e\u003ci class='fa fa-star'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003ci class='fa fa-star-o'\u003e\u003c/i\u003e\u003c/div\u003e"],[10694,42476.86,8866,5488],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.262205","-89.23847261880942","48.468530871630904","48.484280828841214"],["-89.25033880940471","48.47640585023606"],["ignore"],[905,51724.01,622,447],[4176,41358.81453124999,3346,2048,1298],[0,1]],[["-89.23847261880942","-89.21474023761886","48.468530871630904","48.484280828841214"],["-89.22660642821414","48.47640585023606"],["ignore"],[350,44504.75,243,174],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.21474023761886","-89.19100785642829","48.4527809144206","48.468530871630904"],["-89.20287404702357","48.46065589302575"],["ignore"],[9238,42276.86,7486,4508],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.4527809144206","48.468530871630904"],["-89.17914166583299","48.46065589302575"],["ignore"],[4269,38992.35,3639,2286],[4176,41358.81453124999,3346,2048,1298],[1,2]],[["-89.21474023761886","-89.19100785642829","48.468530871630904","48.484280828841214"],["-89.20287404702357","48.47640585023606"],["ignore"],[2349,43171.04,1988,1192],[4176,41358.81453124999,3346,2048,1298],[0,0]],[["-89.19100785642829","-89.1672754752377","48.468530871630904","48.484280828841214"],["-89.17914166583299","48.47640585023606"],["ignore"],[2967,40688.62,2603,1632],[4176,41358.81453124999,3346,2048,1298],[2,6]]]
		
		#Filter output
		rjson2.each_with_index { |box, i| 
			next if(rjson2[i][2][0] == "ignore") 
			#check for population
			tcnt = 0
			rating = 0
			while(tcnt < 10) 
				if(box[3][0].to_i < (params[:filters][0].to_i + (tcnt*params[:filters][0].to_i)) && box[5][0] <= tcnt)
					rjson2[i][2][0] = "ignore"
				end
				tcnt += 1
			end
			next if(rjson2[i][2][0] == "ignore") 
			#calculate location ratings			
			##cost rating of locality
			locPric = (box[3][1]/box[4][1]) * 100
			if(locPric.to_i >= 95 && locPric.to_i <= 105)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 3
			elsif(locPric.to_i >= 80 && locPric.to_i <= 94)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating  = 2
			elsif(locPric.to_i >= 106 && locPric.to_i <= 120)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating  = 4
			elsif(locPric.to_i <= 79)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 1
			elsif(locPric.to_i >= 121)
				rjson2[i][2][0] = "<div class='rating-title'>Cost Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating  = 5
			end
			
			ratings[i][0] = rating
			ratings[i][4] += rating
			if(params[:filters][1].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
			
			next if(rjson2[i][2][0] == "ignore")
			
			##crime rating of locality
			locCrim = ((box[3][3].to_f/(box[3][2].to_f - box[3][3].to_f)) * 100 - 100).to_i
			avgCrim = ((box[4][3].to_f/(box[4][4].to_f)) * 100 - 100).to_i
			crimeRat = (locCrim.to_f/avgCrim.to_f) * 100
			rating = 0
			if(crimeRat.to_i >= 90 && crimeRat.to_i <= 110)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 3
			elsif(crimeRat.to_i >= 111 && crimeRat.to_i <= 130)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating  = 2
			elsif(crimeRat.to_i >= 70 && crimeRat.to_i <= 89)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating  = 4
			elsif(crimeRat.to_i >= 131)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 1
			elsif(crimeRat.to_i <= 69)
				rjson2[i][2][0] += "</br><div class='rating-title'>Crime Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating  = 5
			end
			
			ratings[i][1] = rating
			ratings[i][4] -= rating
			if(params[:filters][2].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
			
		}
		
		totTweets = 0
		actBbox = 0
		totComt = 0
		rjson2.each_with_index{ |box1, j| 
			if(rjson2[j][2][0] != "ignore") 
				totTweets += box1[5][1]
				totComt += box1[5][0]
				actBbox += 1
			end
		}
		avgATwts =  totTweets / actBbox
		rjson2.each_with_index { |box, i| 
			next if(rjson2[i][2][0] == "ignore") 	
			##social rating of locality
			cbbtwts = box[5][1]
			twtRat = 0
			rating = 0
			if(avgATwts != 0)
				twtRat = (box[5][1] - avgATwts)/avgATwts
			end
			
			if(twtRat == 1)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 3
			elsif(twtRat == 0)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating  = 2
			elsif(twtRat == 2)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating  = 4
			elsif(twtRat < 0)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating  = 1
			elsif(twtRat > 2)
				rjson2[i][2][0] += "</br><div class='rating-title'>Social Rating:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating  = 5
			end
			
			ratings[i][2] = rating
			ratings[i][4] += rating
			if(params[:filters][3].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
			
			next if(rjson2[i][2][0] == "ignore")
			
			##social rating of locality
			cbbComt = box[5][0]
			rating = 0
			if(cbbComt == 2)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-half-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating = 3
			elsif(cbbComt == 1)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"			
				rating = 2
			elsif(cbbComt == 3)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star-o'></i></div>"
				rating = 4
			elsif(cbbComt == 0)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i><i class='fa fa-star-o'></i></div>"
				rating = 1
			elsif(cbbComt >= 4)
				rjson2[i][2][0] += "</br><div class='rating-title'>Competition:</div> <div class='rating-rating'><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i><i class='fa fa-star'></i></div>"
				rating = 5
			end
			
			ratings[i][3] = rating
			ratings[i][4] += rating
			if(params[:filters][4].to_i > rating)
				rjson2[i][2][0] = "ignore"
			end
		}
		
		rjson2.each_with_index{ |box, i| box.push(ratings[i]) }
		
		render :json => rjson2
	end
	
	def checkColors
		poiLocs = Array.new
		tweetLocs = Array.new
		bboxescentre = Array.new
		bboxesccolors = Array.new
		rjson = Array.new
		rjson2 = Array.new
		poiLocs = params[:pois]
		tweetLocs = params[:tweets]
		watercolors = ["00FE00", "00FF00"]
		totPop, avgPop, totInc, avgInc, totWF, avgWF, totWFIN, avgWFIN, totWFOUT, avgWFOUT = 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
		
		bboxes = getboxes(params[:center][0].to_f, params[:center][1].to_f)		
		poisInBB = Array.new(bboxes.length) { |i| 0 }
		tweetsInBB = Array.new(bboxes.length) { |i| 0 }
		
		bboxes.each { |x| bboxescentre.push(getcentre(x[0], x[1], x[2], x[3])) }
		
		bboxescentre.each { |x| bboxesccolors.push(getpointtype(x[0],x[1])) }
		
		bboxesccolors.each_with_index{ |x, i| 
			if(watercolors.include?(x[0].to_s[1..-1].upcase)) 
				bboxesccolors[i] = ['ignore']  
			end 
		}
		
		bboxes.each_with_index { |box, x| rjson.push([[box[0].to_s, box[1].to_s, box[2].to_s, box[3].to_s], [bboxescentre[x][0].to_s, bboxescentre[x][1].to_s], bboxesccolors[x]]) }
		
		return rjson
	end
	
	def checkIfPointInBB(bbox, point)
		if(bbox[2].to_s <= point[1].to_s && point[1].to_s <= bbox[3].to_s && bbox[1].to_s <= point[0].to_s && point[0].to_s <= bbox[0].to_s)
			return true;
		else
			return false;
		end
	end
	
	def getarctoken
		response = Net::HTTP.post_form URI('https://www.arcgis.com/sharing/rest/oauth2/token'),
		  f: 'json',
		  client_id: 'hwplwg2E6P7oz7zn',
		  client_secret: '90b5aa6ac78146b6b90b760393ffe79e',
		  grant_type: 'client_credentials'
		return JSON.parse(response.body)['access_token']
	end
	
	def getboxes(longitute, latitute)
		bboxes = Array.new
		boundingbox = getboundingbox(longitute, latitute)
		bboxes.push([boundingbox[0], boundingbox[1], boundingbox[2], boundingbox[3]])
		while (bboxes.length < 40) do
			count = 0
			tbboxes = bboxes.clone
			bboxes.clear
			while (count < tbboxes.length) do
				ibboxes = divideboundingbox(tbboxes[count][0], tbboxes[count][1], tbboxes[count][2], tbboxes[count][3])
				ibboxes.each { |x| bboxes.push(x) }
				count += 1  
			end
		end
		return bboxes
	end
	
	def getboundingbox(longitute, latitute)
		# Longitute and latitute
		lon = deg2rad(longitute)
		lat = deg2rad(latitute)
		
		halfSide = 1000*7

		# Radius of Earth at given latitude
		radius = WGS84EarthRadius(lat)
		# Radius of the parallel at given latitude
		pradius = radius*Math::cos(lat)

		latMin = lat - halfSide/radius
		latMax = lat + halfSide/radius
		lonMin = lon - halfSide/pradius
		lonMax = lon + halfSide/pradius
		
		return [rad2deg(lonMin), rad2deg(lonMax), rad2deg(latMin), rad2deg(latMax)]
	end
	
	def divideboundingbox(minLon, maxLon, minLat, maxLat)
		centLon = (minLon + maxLon)/2.0;
		centLat = (minLat + maxLat)/2.0;
		bboxes = Array.new
		#wrap around to make sure we're not exceeding 90/180
		if(centLon -180 > 0)
			centLon -= 360
		elsif (centLon + 180 < 0)
			centLon += 360
		end
		bboxes.push([minLon, centLon, minLat, centLat])
		bboxes.push([centLon, maxLon, minLat, centLat])
		bboxes.push([minLon, centLon, centLat, maxLat])
		bboxes.push([centLon, maxLon, centLat, maxLat])
		return bboxes
	end
	
	def getcentre(minLon, maxLon, minLat, maxLat)
		centLon = (minLon + maxLon)/2.0;
		centLat = (minLat + maxLat)/2.0;
		#wrap around to make sure we're not exceeding 90/180
		if(centLon -180 > 0)
			centLon -= 360
		elsif (centLon + 180 < 0)
			centLon += 360
		end
		return [centLon, centLat]
	end
	
	def getpointtype(longitute, latitude)
		#original = Magick::Image.read("http://maps.googleapis.com/maps/api/staticmap?center="+latitude.to_s+","+longitute.to_s+"&zoom=15&size=100x100&maptype=roadmap&key=AIzaSyCoi0SFdKRF753IW-jUkfHujoPi5YT5BLY").first
		image = Magick::ImageList.new  
		urlimage = open("http://maps.googleapis.com/maps/api/staticmap?center="+latitude.to_s+","+longitute.to_s+"&zoom=10&size=25x25&visual_refresh=true&key=AIzaSyCoi0SFdKRF753IW-jUkfHujoPi5YT5BLY&style=feature:water|color:0x00FF00&style=element:labels|visibility:off&style=feature:transit|visibility:off&style=feature:poi|visibility:off&style=feature:road|visibility:off&style=feature:administrative|visibility:off&style=feature:landscape|visibility:off") # Image Remote URL 
		original = image.from_blob(urlimage.read)
		# reduce number of colors
		#quantized = original.quantize(TOP_N, Magick::RGBColorspace)
		# Create an image that has 1 pixel for each of the TOP_N colors.
		normal = sort_by_decreasing_frequency(original)
		return get_pix(normal)
	end
	
	# Create a 1-row image that has a column for every color in the quantized
	# image. The columns are sorted decreasing frequency of appearance in the
	# quantized image.
	def sort_by_decreasing_frequency(img)
	  hist = img.color_histogram
	  # sort by decreasing frequency
	  sorted = hist.keys.sort_by {|p| -hist[p]}
	  new_img = Magick::Image.new(hist.size, 1)
	  new_img.store_pixels(0, 0, hist.size, 1, sorted)
	end

	def get_pix(img)
	  palette = Magick::ImageList.new
	  pixels = img.get_pixels(0, 0, img.columns, 1)
	  topColors = Array.new
	  pixels[0..1].each do |p|
		#puts p.to_color(Magick::AllCompliance, false, 8, true)
		topColors << p.to_color(Magick::AllCompliance, false, 8, true).to_s
	  end
	  return topColors
	end
	
	# degrees to radians
	def deg2rad(degrees)
		return Math::PI*degrees/180.0
	end
	# radians to degrees
	def rad2deg(radians)
		return 180.0*radians/Math::PI
	end
	
	# Earth radius at a given latitude, according to the WGS-84 ellipsoid [m]
	def WGS84EarthRadius(lat)
		# Semi-axes of WGS-84 geoidal reference
		@WGS84_a = 6378137.0  # Major semiaxis [m]
		@WGS84_b = 6356752.3  # Minor semiaxis [m]
		# http://en.wikipedia.org/wiki/Earth_radius
		@An = @WGS84_a*@WGS84_a * Math::cos(lat)
		@Bn = @WGS84_b*@WGS84_b * Math::sin(lat)
		@Ad = @WGS84_a * Math::cos(lat)
		@Bd = @WGS84_b * Math::sin(lat)
		return Math::sqrt( (@An*@An + @Bn*@Bn)/(@Ad*@Ad + @Bd*@Bd) )
	end
end
